<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="iOS," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="1.UIKitå’Œè§†å›¾ç»˜å›¾å‘¨æœŸï¼š
å¦‚æœè¦æ”¹å˜è§†å›¾çš„å¤§å°æˆ–æ˜¾ç¤ºï¼Œç”»ä¸€æ¡çº¿ï¼Œæˆ–è€…æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„é¢œè‰²ï¼Œè¿™äº›æ”¹å˜ä¸ä¼šç«‹åˆ»æ˜¾ç¤ºå‡ºæ¥ã€‚æœ‰æ—¶ï¼Œè¿™ä¼šè®©ç¼–å†™å¦‚ä¸‹ä¸æ°å½“ä»£ç çš„å¼€å‘äººå‘˜æ„ŸåŠ¨è¿·æƒ‘ï¼š123456&amp;#123;progressView.hidden = NO; //è¿™ä¸€è¡Œä»€ä¹ˆä¹Ÿä¸åš//åœ¨è¿™é‡Œåšä¸€äº›è€—æ—¶çš„æ“ä½œ[self doSometingTimeConsuming];progressView.hidden = Y">
<meta property="og:type" content="article">
<meta property="og:title" content="æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶">
<meta property="og:url" content="http://yoursite.com/2017/03/18/æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶/index.html">
<meta property="og:site_name" content="é¢ å€’ç¢ç¢å¿µ">
<meta property="og:description" content="1.UIKitå’Œè§†å›¾ç»˜å›¾å‘¨æœŸï¼š
å¦‚æœè¦æ”¹å˜è§†å›¾çš„å¤§å°æˆ–æ˜¾ç¤ºï¼Œç”»ä¸€æ¡çº¿ï¼Œæˆ–è€…æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„é¢œè‰²ï¼Œè¿™äº›æ”¹å˜ä¸ä¼šç«‹åˆ»æ˜¾ç¤ºå‡ºæ¥ã€‚æœ‰æ—¶ï¼Œè¿™ä¼šè®©ç¼–å†™å¦‚ä¸‹ä¸æ°å½“ä»£ç çš„å¼€å‘äººå‘˜æ„ŸåŠ¨è¿·æƒ‘ï¼š123456&amp;#123;progressView.hidden = NO; //è¿™ä¸€è¡Œä»€ä¹ˆä¹Ÿä¸åš//åœ¨è¿™é‡Œåšä¸€äº›è€—æ—¶çš„æ“ä½œ[self doSometingTimeConsuming];progressView.hidden = Y">
<meta property="og:image" content="http://om86drpkf.bkt.clouddn.com/%E7%BB%98%E5%88%B6%E5%8E%9F%E7%90%86%E5%9B%BE.001.jpeg">
<meta property="og:image" content="http://om86drpkf.bkt.clouddn.com/Snip20170318_1.png">
<meta property="og:image" content="http://om86drpkf.bkt.clouddn.com/Snip20170318_2.png">
<meta property="og:image" content="http://om86drpkf.bkt.clouddn.com/Snip20170318_3.png">
<meta property="og:image" content="http://om86drpkf.bkt.clouddn.com/Snip20170318_6.png">
<meta property="og:image" content="http://om86drpkf.bkt.clouddn.com/Snip20170319_1.png">
<meta property="og:image" content="http://om86drpkf.bkt.clouddn.com/Simulator%20Screen%20Shot%202017%E5%B9%B43%E6%9C%8819.png">
<meta property="og:image" content="http://om86drpkf.bkt.clouddn.com/Snip20170319_2.png">
<meta property="og:image" content="http://om86drpkf.bkt.clouddn.com/2017-03-19%2020_40_14.gif">
<meta property="og:image" content="http://om86drpkf.bkt.clouddn.com/Simulator%20Screen%20Shot%202017%E5%B9%B43%E6%9C%8819%E6%97%A5%20%E4%B8%8B%E5%8D%8810.44.15.png">
<meta property="og:updated_time" content="2017-03-19T16:48:19.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶">
<meta name="twitter:description" content="1.UIKitå’Œè§†å›¾ç»˜å›¾å‘¨æœŸï¼š
å¦‚æœè¦æ”¹å˜è§†å›¾çš„å¤§å°æˆ–æ˜¾ç¤ºï¼Œç”»ä¸€æ¡çº¿ï¼Œæˆ–è€…æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„é¢œè‰²ï¼Œè¿™äº›æ”¹å˜ä¸ä¼šç«‹åˆ»æ˜¾ç¤ºå‡ºæ¥ã€‚æœ‰æ—¶ï¼Œè¿™ä¼šè®©ç¼–å†™å¦‚ä¸‹ä¸æ°å½“ä»£ç çš„å¼€å‘äººå‘˜æ„ŸåŠ¨è¿·æƒ‘ï¼š123456&amp;#123;progressView.hidden = NO; //è¿™ä¸€è¡Œä»€ä¹ˆä¹Ÿä¸åš//åœ¨è¿™é‡Œåšä¸€äº›è€—æ—¶çš„æ“ä½œ[self doSometingTimeConsuming];progressView.hidden = Y">
<meta name="twitter:image" content="http://om86drpkf.bkt.clouddn.com/%E7%BB%98%E5%88%B6%E5%8E%9F%E7%90%86%E5%9B%BE.001.jpeg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/03/18/æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶/"/>





  <title> æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶ | é¢ å€’ç¢ç¢å¿µ </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">é¢ å€’ç¢ç¢å¿µ</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="æœç´¢..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/18/æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é¢ å€’">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/IMG_0084.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é¢ å€’ç¢ç¢å¿µ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-03-18T18:20:45+08:00">
                2017-03-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/03/18/æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/03/18/æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>1.UIKitå’Œè§†å›¾ç»˜å›¾å‘¨æœŸï¼š</p>
<p>å¦‚æœè¦æ”¹å˜è§†å›¾çš„å¤§å°æˆ–æ˜¾ç¤ºï¼Œç”»ä¸€æ¡çº¿ï¼Œæˆ–è€…æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„é¢œè‰²ï¼Œè¿™äº›æ”¹å˜ä¸ä¼šç«‹åˆ»æ˜¾ç¤ºå‡ºæ¥ã€‚æœ‰æ—¶ï¼Œè¿™ä¼šè®©ç¼–å†™å¦‚ä¸‹ä¸æ°å½“ä»£ç çš„å¼€å‘äººå‘˜æ„ŸåŠ¨è¿·æƒ‘ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">progressView.hidden = NO; //è¿™ä¸€è¡Œä»€ä¹ˆä¹Ÿä¸åš</div><div class="line">//åœ¨è¿™é‡Œåšä¸€äº›è€—æ—¶çš„æ“ä½œ</div><div class="line">[self doSometingTimeConsuming];</div><div class="line">progressView.hidden = YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç¬¬ä¸€è¡Œï¼ˆprogressView.hidden = NOï¼‰å®é™…ä¸Šæ ¹æœ¬æ²¡æœ‰ä½œç”¨ï¼Œç†è§£è¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚è¿™è¡Œä»£ç ä¸ä¼šä½¿è¿›åº¦è§†å›¾åœ¨æ‰§è¡Œè€—æ—¶æ“ä½œçš„æ—¶å€™æ˜¾ç¤ºå‡ºæ¥ã€‚æ— è®ºè¿™ä¸ªæ–¹æ³•è¿è¡Œå¤šä¹…ï¼Œéƒ½ä¸ä¼šçœ‹åˆ°è§†å›¾æ˜¾ç¤ºå‡ºæ¥</p>
<p>ä¸‹å›¾å±•ç¤ºäº†ç»˜å›¾å¾ªç¯ä¸­å®é™…ä¼šå‘ç”Ÿçš„æ­¥éª¤ï¼š<br><img src="http://om86drpkf.bkt.clouddn.com/%E7%BB%98%E5%88%B6%E5%8E%9F%E7%90%86%E5%9B%BE.001.jpeg"></p>
<p>æ‰€æœ‰çš„ç»˜åˆ¶éƒ½å‘ç”Ÿåœ¨ä¸»çº¿ç¨‹ï¼Œåªè¦ä»£ç è¿è¡Œåœ¨ä¸»çº¿ç¨‹ï¼Œå°±æ²¡æœ‰ä¸œè¥¿å¯ä»¥ç»˜åˆ¶ã€‚åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œé•¿æ—¶é—´è¿è¡Œæ“ä½œï¼Œä¼šé˜»ç¢äº‹ä»¶çš„å¤„ç†ï¼Œä¹Ÿä¼šé˜»ç¢ç»˜åˆ¶æ›´æ–°ã€‚</p>
<p>å¦‚ä½•å¼€å§‹å’Œåœæ­¢ä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œæ“ä½œçš„æ´»åŠ¨æŒ‡ç¤ºå™¨ï¼Ÿé‡‡ç”¨è°ƒåº¦æˆ–æ‰§è¡Œé˜Ÿåˆ—æ¥å°†è€—æ—¶çš„ä»»åŠ¡æ”¾å…¥åå°ï¼ŒåŒæ—¶åˆ›å»ºå¦‚ä¸‹åœ¨ä¸»çº¿ç¨‹ä¸­è¿›è¡ŒUIKitè°ƒç”¨çš„ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">-(IBAction)doSomething:(UIButton *)sender&#123;</div><div class="line">//é¿å…æ‰§è¡Œä»»åŠ¡æœŸé—´åå¤ç‚¹å‡»</div><div class="line">[sender setEnabled:NO];</div><div class="line">[self.activity startAnimation];</div><div class="line">//æŠŠè€—æ—¶çš„æ“ä½œæ”¾åœ¨åå°çº¿ç¨‹ï¼Œè®©å½“å‰æ–¹æ³•è¿…é€Ÿæ‰§è¡Œå®Œï¼Œè€Œä¸æ˜¯å› ä¸ºè€—æ—¶æ“ä½œè€Œé˜»å¡åœ¨è¿™é‡Œï¼Œè€Œé˜»ç¢ç»˜åˆ¶æ›´æ–°ï¼Œé˜»ç¢è§¦æ‘¸äº‹ä»¶</div><div class="line">dispatch_queue_t bgQueue = dispatch_get_global_queue(0, 0);</div><div class="line">dispatch_async(bgQueue, ^&#123;</div><div class="line">//è€—æ—¶æ“ä½œ</div><div class="line">[self doSomethingTimeConsuming];</div><div class="line">//å›åˆ°ä¸»çº¿ç¨‹ç»˜å›¾</div><div class="line">dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">[self.activity endAnimation];</div><div class="line">[sender setEnabled:YES];</div><div class="line">&#125;);</div><div class="line">&#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2.è§†å›¾ç»˜åˆ¶ä¸è§†å›¾å¸ƒå±€</p>
<p>UIViewå°†å­è§†å›¾çš„å¸ƒå±€(é‡æ–°æ’åˆ—)ä»ç»˜å›¾(æ˜¾ç¤º)ä¸­ç‹¬ç«‹å‡ºæ¥ã€‚è¿™å¯¹æå¤§ç¨‹åº¦çš„ä¼˜åŒ–æ€§èƒ½å¾ˆé‡è¦ï¼Œå› ä¸ºå¸ƒå±€çš„æˆæœ¬é€šå¸¸è¦æ¯”ç»˜åˆ¶ä½ã€‚å¸ƒå±€çš„æˆæœ¬ä¹‹æ‰€ä»¥ä½ï¼Œæ˜¯å› ä¸ºUIViewçš„ç¼“å­˜é€šè¿‡GPUä¼˜åŒ–çš„ä½å›¾è¿›è¡Œç»˜å›¾æ“ä½œã€‚ä½¿ç”¨GPUï¼Œå¯ä»¥ä½¿è¿™äº›ä½å›¾çš„ç§»åŠ¨ï¼Œæ˜¾ç¤ºï¼Œéšè—ï¼Œæ—‹è½¬ï¼Œç”šè‡³å˜å½¢å’Œåˆå¹¶çš„æˆæœ¬éå¸¸ä½ã€‚</p>
<p>å¦‚æœå¯¹ä¸€ä¸ªè§†å›¾è°ƒç”¨setNeedsDisplayæ–¹æ³•ï¼Œå®ƒè¢«æ ‡è®°ä¸ºâ€œéœ€è¦åˆ·æ–°çš„â€ï¼Œå¹¶ä¸”ä¼šåœ¨ä¸‹ä¸€æ¬¡ç»˜å›¾å‘¨æœŸä¸­é‡æ–°ç»˜åˆ¶ã€‚é™¤éè§†å›¾çš„å†…å®¹çœŸçš„ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦åˆ™è¯·ä¸è¦è°ƒç”¨å®ƒã€‚å¤§éƒ¨åˆ†UIKitè§†å›¾ä¼šåœ¨å…¶æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶è‡ªåŠ¨ç®¡ç†é‡ç»˜æ“ä½œï¼Œå› æ­¤é™¤äº†è‡ªå®šä¹‰çš„è§†å›¾ï¼Œä¸€èˆ¬å¹¶ä¸éœ€è¦è°ƒç”¨setNeedsDisplayã€‚</p>
<p>æ—‹è½¬è®¾å¤‡æˆ–æ»šåŠ¨è§†å›¾åï¼Œå­è§†å›¾éœ€è¦é‡æ–°æ’åˆ—ï¼Œè¿™æ—¶UIKitä¼šè°ƒç”¨setNeedsLayoutï¼Œä¹Ÿå°±æ˜¯å¯¹äºå‘ç”Ÿå˜åŒ–çš„è§†å›¾é€æ¬¡è°ƒç”¨layoutSubViewsæ–¹æ³•ã€‚è¦†ç›–layoutSubviewsçš„è¯ï¼Œå°±å¯ä»¥è®©åº”ç”¨åœ¨è®¾å¤‡æ—‹è½¬æˆ–è§†å›¾æ»šåŠ¨æ—¶æ›´åŠ æµç•…ã€‚ä¸å¿…é‡ç»˜å°±èƒ½é‡æ–°æ’åˆ—å­è§†å›¾çš„ä½ç½®ï¼Œè¿˜å¯ä»¥æ ¹æ®è®¾å¤‡æ–¹å‘æ˜¾ç¤ºéšè—è§†å›¾ã€‚å¦‚æœæ•°æ®æ”¹å˜ååªéœ€è¦è¿›è¡Œå¸ƒå±€æ›´æ–°(è€Œéç»˜åˆ¶)ï¼Œåˆ™å¯ä»¥è°ƒç”¨setNeedsLayoutæ–¹æ³•ã€‚</p>
<p>3.è‡ªå®šä¹‰è§†å›¾ç»˜åˆ¶</p>
<p>è§†å›¾å¯ä»¥é€šè¿‡å­è§†å›¾ã€å›¾å±‚æˆ–å®ç°drawRectï¼šæ–¹æ³•æ¥è¡¨ç°å†…å®¹ã€‚é€šå¸¸æ¥è¯´ï¼Œå¦‚æœå®ç°äº†drawRectï¼šæ–¹æ³•ï¼Œæœ€å¥½å°±ä¸è¦å†æ··ç”¨å›¾å±‚ä¸å­è§†å›¾äº†ã€‚<br>2Dç»˜å›¾å¹¶ä¸èƒ½æ“ä½œå•ç‹¬çš„åƒç´ ï¼Œå› ä¸ºåƒç´ æ˜¯ä¾èµ–ç›®æ ‡çš„ã€‚å¯ä»¥ä»ä½å›¾ä¸Šä¸‹æ–‡ä¸­è¯»å–å®ƒï¼Œä½†æ— æ³•ä½¿ç”¨UIKitæˆ–Core Graphicså‡½æ•°æ¥ç›´æ¥ä½œç”¨äºå®ƒã€‚</p>
<p>4.ç†è§£åæ ‡ç³»</p>
<p>åæ ‡ã€ç‚¹ã€åƒç´ ä¹‹é—´çš„å¾®å¦™è½¬æ¢ä¹Ÿå¯èƒ½é™ä½ç»˜åˆ¶æ€§èƒ½ï¼Œåˆ°æ‰§è¡Œçº¿æ¡å’Œæ–‡å­—æ¨¡ç³Šã€‚è§‚å¯Ÿä»¥ä¸‹ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//ç»˜åˆ¶ä¸€ï¼š</div><div class="line">CGContextSetLineWidth(context,3.);</div><div class="line">CGContextMoveLineToPoint(context,10.,100.);</div><div class="line">CGContextAddLineToPoint(context,200.,100.);</div><div class="line">CGContextStrokePath(context);</div><div class="line">//ç»˜åˆ¶äºŒï¼š</div><div class="line">CGContextMoveToPoint(context,10.,105.5);</div><div class="line">CGContextAddLineToPoint(context,200.,105.5);</div><div class="line">CGContextStrokePath(context);</div></pre></td></tr></table></figure></p>
<p>ä¸‹å›¾å±•ç¤ºçš„æ˜¯åœ¨éè§†ç½‘è†œå±å¹•ä¸Šçš„è¾“å‡ºç»“æœï¼Œå½“æ”¾å¤§çš„æ—¶å€™å¯ä»¥çœ‹è§ï¼Œä¸¤æ¡çº¿æ¡ä¹‹é—´çš„åŒºåˆ«ï¼š<br><img src="http://om86drpkf.bkt.clouddn.com/Snip20170318_1.png"><br>å¯ä»¥çœ‹åˆ°ï¼Œç»˜åˆ¶ä¸€çš„ç»“æœå°±è¦æ¨¡ç³Šå¾ˆå¤šã€‚åŸå› åœ¨äºiOSå¯¹åæ ‡ç³»çš„è§£è¯»æ–¹å¼ã€‚<br>æ„é€ ä¸€ä¸ªCGPathæ—¶ï¼Œä¾¿æ˜¯ä½¿ç”¨äº†å‡ ä½•åæ ‡ç³»ï¼Œè¿™ä¸æ•°å­¦ä¸­ä½¿ç”¨çš„åæ ‡ç³»æ˜¯ä¸€æ ·çš„ï¼Œä»¥ä¸¤æ¡ç½‘æ ¼çº¿çš„äº¤ç‚¹æ¥è¡¨ç¤ºé›¶åæ ‡ç‚¹ã€‚ä½ æ— æ³•ç»˜åˆ¶å‡ºçœŸæ­£çš„å‡ ä½•ç‚¹æˆ–å‡ ä½•çº¿æ¡ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯æ— é™å°å’Œæ— é™ç»†çš„ã€‚iOSç»˜åˆ¶ä¸­å¿…é¡»å°†è¿™äº›å‡ ä½•å¯¹è±¡è½¬æ¢æˆåƒç´ åæ ‡ã€‚åƒç´ æ˜¯è®¾å¤‡èƒ½æ§åˆ¶çš„æœ€å°æ˜¾ç¤ºåŒºåŸŸå•ä½ã€‚<br><img src="http://om86drpkf.bkt.clouddn.com/Snip20170318_2.png"><br>è°ƒç”¨CGContextStrokePathï¼ŒiOSä¼šè®©çº¿æ¡æ²¿è·¯å¾„å±…ä¸­ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œçº¿å®½æœ‰3åƒç´ å®½ï¼Œæ‰€ä»¥y=98.5åˆ°y=101.5ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="http://om86drpkf.bkt.clouddn.com/Snip20170318_3.png"><br>åœ¨å±å¹•ä¸Šï¼Œçº¿æ¡çœ‹èµ·æ¥æœ‰äº›æ¨¡ç³Šã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•å°±æ˜¯å°†æ°´å¹³æˆ–å‚ç›´çš„çº¿æ¡ç§»åŠ¨åˆ°åŠä¸ªç‚¹çš„ä½ç½®ï¼Œè¿™æ ·å½“iOSå°†çº¿æ¡å±…ä¸­æ—¶ï¼Œè¾¹ç¼˜åˆšå¥½å°±æ˜¯åƒç´ çš„è¾¹ç•Œã€‚æˆ–è€…è®©çº¿æ¡æ›´ç²—ä¸€äº›ã€‚<br>ä½¿ç”¨éæ•´å‹å®½åº¦çš„çº¿æ¡ï¼Œæˆ–è€…åæ ‡ç³»ä¸æ˜¯æ•´å‹å’ŒåŠæ•´å‹æ—¶(è¿™ä¸ªé—®é¢˜ä¹Ÿä½¿ç”¨äºretinaå±)ï¼Œä¹Ÿæœ‰å¯èƒ½é‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚è®©iOSç»˜åˆ¶å°æ•°åƒç´ æ—¶å°±æœ‰å¯èƒ½å¯¼è‡´æ¨¡ç³Šã€‚</p>
<p>å¡«å……å·¥å…·ä¸ç”»ç¬”ä¸ä¸€æ ·ã€‚ç”»ç¬”çš„çº¿æ¡æ˜¯ä¸­å¿ƒå¯¹é½è·¯å¾„çš„ï¼Œè€Œå¡«å……é¢œè‰²æ˜¯åŸºäºè·¯å¾„çš„ã€‚å¦‚æœå¡«å……ä»{10,100}åˆ°{200,103}çš„çŸ©å½¢ï¼Œæ¯ä¸ªåƒç´ éƒ½ä¼šè¢«æ­£ç¡®å¡«å……ï¼Œå¦‚å›¾<br><img src="http://om86drpkf.bkt.clouddn.com/Snip20170318_6.png"><br>ç›®å‰çš„è®¨è®ºè§†ç‚¹ä¸åƒç´ ç›¸åŒã€‚è€Œå¯¹äºretinaå±å¹•ï¼Œä¹Ÿä¾ç„¶ä¼šå› ä¸ºçº¿å®½æˆ–åæ ‡ç³»ä¸æ˜¯æ•´æ•°å¯¼è‡´æ˜¾ç¤ºæ¨¡ç³Šçš„é—®é¢˜ã€‚</p>
<p>5.å˜å½¢</p>
<p>iOSå¹³å°ä½¿ç”¨äº†å¯ä»¥å¿«é€Ÿè¿›è¡ŒçŸ©å½¢è®¡ç®—çš„ä¼˜ç§€çš„GPUã€‚å¦‚æœå°†ğŸ‘‰ç»˜å›¾è¿ç®—è½¬æ¢æˆçŸ©å½¢è®¡ç®—æœºğŸ‘ˆï¼Œå°±å¯ä»¥å‘æŒ¥GPUçš„èƒ½åŠ›å¹¶è·å–å“è¶Šçš„åŠŸèƒ½ã€‚å˜å½¢å°±æ˜¯ä¸€ç§çŸ©å½¢è¿ç®—ã€‚<br>iOSæœ‰ä¸¤ç§å˜å½¢ï¼šä»¿å°„ä¸3Dã€‚UIViewåªèƒ½å¤„ç†ä»¿å°„å˜å½¢ã€‚ä»¿å°„å˜å½¢å¯ä»¥ç”¨çŸ©é˜µè¿ç®—æ¥è¡¨ç°æ—‹è½¬ã€ç¼©æ”¾ã€å‰ªåˆ‡ä»¥åŠå¹³ç§»ã€‚<br><img src="http://om86drpkf.bkt.clouddn.com/Snip20170319_1.png"></p>
<p>iOSæ‹¥æœ‰æ”¯æŒæ—‹è½¬ã€ç¼©æ”¾ä»¥åŠå¹³ç§»çš„å‡½æ•°ã€‚</p>
<p>å˜å½¢å¯ä»¥å¤§å¤§ç®€åŒ–ä»£ç ï¼Œå¹¶æå‡å®ƒçš„é€Ÿåº¦ã€‚</p>
<p>è´´ä¸Šä¸‹é¢è¿™æ ·ä¸€æ®µä»£ç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">- (void)drawRect:(CGRect)rect &#123;</div><div class="line">// Drawing code</div><div class="line">CGSize size = self.bounds.size;</div><div class="line">CGFloat margin = 10;</div><div class="line">CGFloat radius = rintf(MIN(size.width - margin, size.height - margin) / 4);</div><div class="line">CGFloat xOffset, yOffset;</div><div class="line">CGFloat offset = rintf((size.height - size.width)/2);</div><div class="line">if (offset &gt; 0) &#123;</div><div class="line">//rint(double x)ï¼š ä¸å¤§äºxçš„æœ€å¤§æ•´æ•°ï¼Œè¯¥æ•´æ•°æ˜¯åŒç²¾åº¦å®æ•°</div><div class="line">xOffset = rint(margin /  2);</div><div class="line">yOffset = offset;</div><div class="line">&#125;else&#123;</div><div class="line">xOffset = -offset;</div><div class="line">yOffset = rint(margin / 2);</div><div class="line">&#125;</div><div class="line">[[UIColor redColor] setFill];</div><div class="line">UIBezierPath *path = [UIBezierPath bezierPath];</div><div class="line">[path addArcWithCenter:CGPointMake(radius * 2 + xOffset, radius + yOffset) radius:radius startAngle:-M_PI endAngle:0 clockwise:YES];</div><div class="line">[path addArcWithCenter:CGPointMake(radius * 3 + xOffset, radius * 2 + yOffset) radius:radius startAngle:-M_PI_2 endAngle:M_PI_2 clockwise:YES];</div><div class="line">[path addArcWithCenter:CGPointMake(radius * 2 + xOffset, radius * 3 + yOffset) radius:radius startAngle:0 endAngle:M_PI clockwise:YES];</div><div class="line">[path addArcWithCenter:CGPointMake(radius + xOffset, radius * 2 + yOffset) radius:radius startAngle:M_PI_2 endAngle:-M_PI_2 clockwise:YES];</div><div class="line">[path closePath];</div><div class="line">[path fill];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿è¡Œå¾—åˆ°çš„æ•ˆæœï¼š<br><img src="http://om86drpkf.bkt.clouddn.com/Simulator%20Screen%20Shot%202017%E5%B9%B43%E6%9C%8819.png"><br>ä»è¿™æ®µä»£ç å¯ä»¥çœ‹å‡ºï¼Œè¿™é‡ŒåŒ…æ‹¬å¤ªå¤šçš„è¾“å…¥ä¸è¿ç®—ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œåœ¨åæ ‡ç³»ç©ºé—´ä¸­å›´ç»•åŸç‚¹è¿›è¡Œç»˜åˆ¶ç„¶åå¯¹ç»˜åˆ¶è¿›è¡Œç¼©æ”¾ã€æ—‹è½¬ã€å¹³ç§»è€Œæ›´ç®€å•ã€‚å¦‚æœæŠŠå›¾å½¢ç»˜åˆ¶åœ¨ä¸€ä¸ª4x4çš„æ ¼å­ä¸­ä¼šæ€æ ·ï¼Ÿ<br><img src="http://om86drpkf.bkt.clouddn.com/Snip20170319_2.png"></p>
<p>ç°åœ¨ç»˜åˆ¶çš„è®¡ç®—å°±å˜å¾—éå¸¸ç®€å•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">- (void)drawRect:(CGRect)rect &#123;</div><div class="line">CGSize size = self.bounds.size;</div><div class="line">CGFloat margin = 10;</div><div class="line"></div><div class="line">[[UIColor redColor] set];</div><div class="line">UIBezierPath *path = [UIBezierPath bezierPath];</div><div class="line">[path addArcWithCenter:CGPointMake(0, -1) radius:1 startAngle:-M_PI endAngle:0 clockwise:YES];</div><div class="line"></div><div class="line">[path addArcWithCenter:CGPointMake(1, 0) radius:1 startAngle:-M_PI_2 endAngle:M_PI_2 clockwise:YES];</div><div class="line"></div><div class="line">[path addArcWithCenter:CGPointMake(0, 1) radius:1 startAngle:0 endAngle:M_PI clockwise:YES];</div><div class="line"></div><div class="line">[path addArcWithCenter:CGPointMake(-1, 0) radius:1 startAngle:M_PI_2 endAngle:-M_PI_2 clockwise:YES];</div><div class="line"></div><div class="line">[path closePath];</div><div class="line"></div><div class="line">CGFloat scale = floorf((MIN(size.height, size.width) - margin) / 4);</div><div class="line">CGAffineTransform transform;</div><div class="line">transform = CGAffineTransformMake(scale, 0.0f, 0.f, scale, size.width/2, size.height/2);</div><div class="line">[path applyTransform:transform];</div><div class="line">[path fill];</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªæŠ€æœ¯å¯ä»¥ç”¨æ¥ä»¥å„ç§è§’åº¦ç»˜åˆ¶å¤æ‚çš„å½¢çŠ¶ã€‚æ¯”å¦‚è¯´ï¼Œç»˜åˆ¶ä¸€ä¸ªæŒ‡å‘å³ä¸Šè§’çš„ç®­å¤´ï¼Œä¸€èˆ¬å…ˆç”»ä¸€æ¡æŒ‡å‘å³è¾¹çš„ç®­å¤´å†æ—‹è½¬å®ƒä¼šæ›´å®¹æ˜“ã€‚<br>å¯ä»¥é€‰æ‹©ä½¿ç”¨applyTransform:å¯¹è·¯å¾„è¿›è¡Œå˜å½¢ã€‚</p>
<p>6.é€šè¿‡Core Graphicsè¿›è¡Œç»˜åˆ¶<br>ç»˜åˆ¶æ•ˆæœï¼š<br>ç»˜åˆ¶ä»£ç ï¼š<br><img src="http://om86drpkf.bkt.clouddn.com/2017-03-19%2020_40_14.gif"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line">#import &quot;TCView.h&quot;</div><div class="line"></div><div class="line"></div><div class="line">@interface TCView()</div><div class="line"></div><div class="line">@property(nonatomic, readwrite, strong) NSMutableArray  *values;</div><div class="line">@property(nonatomic,readwrite, strong) dispatch_source_t timer;</div><div class="line"></div><div class="line">@end</div><div class="line">@implementation TCView</div><div class="line"></div><div class="line">const CGFloat kXScale = 5.0;</div><div class="line">const CGFloat kYScale = 100.0;</div><div class="line">static inline CGAffineTransform  CGAffineTransformMakeScaleTranslate(CGFloat sx,CGFloat sy, CGFloat dx, CGFloat dy)&#123;</div><div class="line">return CGAffineTransformMake(sx, 0.f, 0.f, sy, dx, dy);</div><div class="line">&#125;</div><div class="line">-(void)awakeFromNib&#123;</div><div class="line">[super awakeFromNib];</div><div class="line">[self setContentMode:UIViewContentModeRight];</div><div class="line">self.values = [NSMutableArray array];</div><div class="line">__weak typeof (self) weakSelf = self;</div><div class="line">double delayInseconds = 0.25;</div><div class="line">self.timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, 0, 0, dispatch_get_main_queue());</div><div class="line">//è®¾ç½®timer</div><div class="line">dispatch_source_set_timer(self.timer, dispatch_walltime(NULL, 0), (unsigned)(delayInseconds * NSEC_PER_SEC), 0);</div><div class="line">//ç»™timeræ·»åŠ äº‹ä»¶å¤„ç†</div><div class="line">dispatch_source_set_event_handler(self.timer, ^&#123;</div><div class="line">[weakSelf updateValues];</div><div class="line">&#125;);</div><div class="line">//æ‰‹åŠ¨å¼€å§‹</div><div class="line">dispatch_resume(self.timer);</div><div class="line">&#125;</div><div class="line">-(void)updateValues&#123;</div><div class="line">//RAND_MAX rand()æ‰€èƒ½å¤Ÿè·å–åˆ°çš„æœ€å¤§çš„å€¼</div><div class="line">//rand()è¿”å›çš„æ˜¯intç±»å‹ random()è¿”å›çš„æ˜¯longç±»å‹</div><div class="line">//((double)rand() / (double)RAND_MAX) è·å¾—ä¸€ä¸ªéšæœºçš„0-1çš„doubleç±»å‹çš„æ•°</div><div class="line">double nextValue = sin(CFAbsoluteTimeGetCurrent()) + ((double)rand() / (double)RAND_MAX);</div><div class="line">//</div><div class="line">[self.values addObject:[NSNumber numberWithDouble:nextValue]];</div><div class="line"></div><div class="line">CGSize size = self.bounds.size;</div><div class="line">//æœ€å¤§çš„å°ºå¯¸</div><div class="line">//floor(x)è¿”å›çš„æ˜¯å°äºæˆ–ç­‰äºxçš„æœ€å¤§æ•´æ•°</div><div class="line">//floorl(x) è¿”å›çš„ç±»å‹æ˜¯ long double</div><div class="line">//floorf(x) è¿”å›ç±»å‹æ˜¯ float</div><div class="line">CGFloat maxDimension = MAX(size.height, size.width);</div><div class="line">NSUInteger maxValues = (NSUInteger)floorl(maxDimension / kXScale);</div><div class="line"></div><div class="line">if ([self.values count] &gt; maxValues) &#123;</div><div class="line">[self.values removeObjectsInRange:NSMakeRange(0, [self.values count] - maxValues)];</div><div class="line">&#125;</div><div class="line">//ç»˜åˆ¶</div><div class="line">[self setNeedsDisplay];</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)dealloc&#123;</div><div class="line">dispatch_source_cancel(_timer);</div><div class="line">&#125;</div><div class="line">- (void)drawRect:(CGRect)rect &#123;</div><div class="line">if ([self.values count] == 0) &#123;</div><div class="line">return;</div><div class="line">&#125;</div><div class="line">CGContextRef ctx = UIGraphicsGetCurrentContext();</div><div class="line">CGContextSetStrokeColorWithColor(ctx, [[UIColor redColor] CGColor]);</div><div class="line">CGContextSetLineJoin(ctx, kCGLineJoinRound);</div><div class="line">CGContextSetLineWidth(ctx, 5);</div><div class="line">//åŒ…å«æ‰€æœ‰çº¿æ¡çš„è·¯å¾„</div><div class="line">CGMutablePathRef  path = CGPathCreateMutable();</div><div class="line"></div><div class="line">CGFloat yOffset = self.bounds.size.height / 2;</div><div class="line">//è·¯å¾„æ”¾å¤§ï¼Œå¹³ç§»è·¯å¾„()</div><div class="line">CGAffineTransform transform = CGAffineTransformMakeScaleTranslate(kXScale, kYScale, 0, yOffset);</div><div class="line">//</div><div class="line">CGFloat y = [[self.values objectAtIndex:0] floatValue];</div><div class="line">CGPathMoveToPoint(path, &amp;transform, 0, y);</div><div class="line">for (NSUInteger x = 1; x &lt; [self.values count]; ++x) &#123;</div><div class="line">y = [[self.values objectAtIndex:x] floatValue];</div><div class="line">CGPathAddLineToPoint(path, &amp;transform, x, y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">CGContextAddPath(ctx, path);</div><div class="line">//create çš„ å°±è¦release</div><div class="line">CGPathRelease(path);</div><div class="line">//ç»˜åˆ¶</div><div class="line">CGContextStrokePath(ctx);</div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure></p>
<p>7.æ··ç”¨UIKitä¸Core Graphics</p>
<p>åœ¨drawRect:æ–¹æ³•ä¹‹å¤–ä½ å¯èƒ½ä¼šå‘ç°ä½¿ç”¨Core Graphicsç»˜åˆ¶çš„ä¸œè¥¿ä¼šä¸Šä¸‹é¢ å€’ã€‚UIKitéµå®ˆULOï¼ˆUpper-Left-Origin,å·¦ä¸Šè§’ä¸ºåŸç‚¹ï¼‰çš„åæ ‡ç³»ç»Ÿï¼Œè€ŒCore Graphicsé»˜è®¤ä½¿ç”¨LLO(Lower-Left-Originï¼Œå·¦ä¸‹è§’ä¸ºåŸç‚¹)çš„åæ ‡ç³»ç»Ÿã€‚åªè¦ä½¿ç”¨åœ¨drawRect:æ–¹æ³•ä¸­é€šè¿‡UIGraphicsGetCurrentContextè¿”å›çš„ä¸Šä¸‹æ–‡ï¼Œé‚£ä¹ˆä¸€åˆ‡å°±æ­£å¸¸äº†ï¼Œå› ä¸ºè¿™ä¸ªä¸Šä¸‹æ–‡æ˜¯å·²ç»åè½¬çš„ã€‚ä¸è¿‡ä½¿ç”¨CGBitmapContextCreateè¿™æ ·çš„å‡½æ•°åˆ›å»ºè‡ªå·±çš„ä¸Šä¸‹æ–‡ï¼Œå®ƒä¼šä»¥å·¦ä¸‹è§’ä¸ºåŸç‚¹ã€‚å¯ä»¥è¿›è¡Œåå‘è®¡ç®—æˆ–è€…åè½¬ä¸Šä¸‹æ–‡ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">CGContextTranslateCTM(ctx, 0, height);</div><div class="line">CGContextScaleCTM(ctx, 1.0f, -1.0f);</div></pre></td></tr></table></figure></p>
<p>è¿™æ®µä»£ç å¹³ç§»äº†ä¸Šä¸‹æ–‡çš„é«˜åº¦å¹¶ä½¿ç”¨ä¸€ä¸ªè´Ÿæ•°æ¯”ä¾‹è¿›è¡Œåè½¬ã€‚å¦‚æœæƒ³è®©UIKitä½¿ç”¨Core graphicsï¼Œå˜å½¢åˆ™åº”è¯¥åè¿‡æ¥ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">CGContextScaleCTM(ctx,1.0f,-1.0f);</div><div class="line">CGContextTranslateCTM(ctx,1.0f,-1.0f);</div></pre></td></tr></table></figure></p>
<p>å…ˆåè½¬ï¼Œå†å¹³ç§»ã€‚</p>
<p>8.ç®¡ç†å›¾å½¢ä¸Šä¸‹æ–‡</p>
<p>åœ¨è°ƒç”¨drawRect:æ–¹æ³•ä¹‹å‰ï¼Œç»˜å›¾ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªå›¾å½¢ä¸Šä¸‹æ–‡ã€‚ä¸Šä¸‹æ–‡åŒ…æ‹¬å¤§é‡ä¿¡æ¯ï¼Œæ¯”å¦‚ç”»ç¬”é¢œè‰²ã€æ–‡å­—é¢œè‰²ã€å½“å‰å­—ä½“ã€å˜å½¢ç­‰ã€‚æœ‰æ—¶ä½ å¯èƒ½ä¿®æ”¹ä¸Šä¸‹æ–‡å¹¶ä½¿å…¶æ¢å¤åŸæ ·ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½ ç°åœ¨æœ‰ä¸€ä¸ªä½¿ç”¨ç‰¹å®šé¢œè‰²ç»˜åˆ¶ç‰¹å®šå½¢çŠ¶çš„å‡½æ•°ã€‚ç”±äºç³»ç»Ÿåªæœ‰ä¸€åªç¬”ï¼Œå› æ­¤åœ¨æ›´æ”¹é¢œè‰²åï¼Œå°±ä¼šå½±å“è°ƒç”¨å‡½æ•°çš„ç»“æœã€‚ä¸ºäº†é¿å…è¿™ä¸ªå‰¯ä½œç”¨ï¼Œå¯ä»¥ä½¿ç”¨CGContextSaveGStateå’ŒCGContextRestoreGStateå°†ä¸Šä¸‹æ–‡å…¥æ ˆå’Œå‡ºæ ˆã€‚</p>
<p>CGContextSaveGStateè®°å½•å½“å‰ä¸Šä¸‹æ–‡çš„çŠ¶æ€ã€‚UIGraphicsPushContextæ›´æ”¹å½“å‰ä¸Šä¸‹æ–‡ã€‚ä»¥ä¸‹æ˜¯CGContextSaveGStateçš„ç¤ºä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[[UIColor redColor] setFill];</div><div class="line">CGContextSaveGState(UIGraphicsGetCurrentContext());</div><div class="line">[[UIColor blackColor] setFill];</div><div class="line">CGContextRestoreGState(UIGraphicsGetCurrentContext());</div><div class="line">UIRectFill(CGRectMake(10 , 10 , 100, 100));</div></pre></td></tr></table></figure></p>
<p>åœ¨è¿™é‡Œè®¾ç½®äº†ç”»ç¬”çš„é¢œè‰²ä¸ºçº¢è‰²ï¼Œå¹¶ä¸”ä¿å­˜äº†ä¸Šä¸‹æ–‡ã€‚ä¹‹åå°†ç”»ç¬”é¢œè‰²æ”¹ä¸ºé»‘è‰²å¹¶æ¢å¤ä¸Šä¸‹æ–‡ã€‚è¿™æ ·å½“ç»˜åˆ¶çš„æ—¶å€™ï¼Œç”»ç¬”çš„é¢œè‰²å˜æˆäº†çº¢è‰²ã€‚</p>
<p>ä½¿ç”¨UIGraphicsPushContextå¹¶ä¸èƒ½ä¿å­˜ä¸Šä¸‹æ–‡çš„å½“å‰çŠ¶æ€(ç”»ç¬”é¢œè‰²ã€çº¿æ¡å®½åº¦ç­‰)ï¼Œè€Œæ˜¯å®Œå…¨åˆ‡æ¢ä¸Šä¸‹æ–‡ã€‚å‡è®¾ä½ æ­£åœ¨å½“å‰è§†å›¾ä¸Šä¸‹æ–‡ä¸­ç»˜åˆ¶ä»€ä¹ˆä¸œè¥¿ï¼Œè¿™æ˜¯æƒ³è¦åœ¨ä½å›¾ä¸Šä¸‹æ–‡ä¸­ç»˜åˆ¶å®Œå…¨ä¸åŒçš„ä¸œè¥¿ã€‚å¦‚æœè¦ä½¿ç”¨UIKitæ¥è¿›è¡Œä»»æ„ç»˜å›¾ï¼Œä½ ä¼šå¸Œæœ›ä¿å­˜å½“å‰çš„UIKitä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬æ‰€æœ‰å·²ç»ç»˜åˆ¶çš„å†…å®¹ï¼Œæ¥ç€åˆ‡æ¢åˆ°ä¸€ä¸ªå…¨æ–°çš„ç»˜å›¾ä¸Šä¸‹æ–‡ä¸­ã€‚è¿™å°±æ˜¯UIGraphicsPushContextçš„åŠŸèƒ½ã€‚åˆ›å»ºå®Œä½å›¾åï¼Œå†å°†ä½ çš„æ—§ä¸Šä¸‹æ–‡å‡ºæ ˆã€‚è€Œè¿™å°±æ˜¯UIGraçš„åŠŸèƒ½ã€‚è¿™ç§æƒ…å†µåªä¼šåœ¨è¦ä½¿ç”¨UIKitåœ¨æ–°çš„ä½å›¾ä¸Šä¸‹æ–‡ä¸­ç»˜å›¾æ—¶æ‰ä¼šå‘ç”Ÿã€‚åªè¦ä½ ä½¿ç”¨çš„æ˜¯Core Graphicså‡½æ•°ï¼Œå°±ä¸éœ€è¦å»æ‰§è¡Œä¸Šä¸‹æ–‡å…¥æ ˆå’Œå‡ºæ ˆï¼Œå› ä¸ºCore Graphicså‡½æ•°å°†ä¸Šä¸‹æ–‡è§†ä½œå‚æ•°ã€‚</p>
<p>è¿™æ˜¯æå…¶é‡è¦çš„å¸¸è§æ“ä½œã€‚å› ä¸ºå…¶å¸¸ç”¨æ€§ï¼Œè‹¹æœå…¬å¸ä¸ºå…¶åˆ›å»ºäº†ä¸€ä¸ªå«åšUIGraphicsBeginImageContextçš„å¿«æ·æ–¹å¼ã€‚å®ƒè´Ÿè´£å°†æ—§çš„ä¸Šä¸‹æ–‡å‡ºæ ˆã€ä¸ºæ–°çš„ä¸Šä¸‹æ–‡åˆ†é…å†…å­˜ã€åˆ›å»ºæ–°çš„ä¸Šä¸‹æ–‡ï¼Œåè½¬åæ ‡ç³»ç»Ÿï¼Œå¹¶å°†å…¶ä½œä¸ºå½“å‰çš„ä¸Šä¸‹æ–‡ä½¿ç”¨ã€‚<br>ä¸‹é¢æ˜¯åˆ›å»ºä¸€å¼ å›¾ç‰‡å¹¶ä½¿ç”¨UIGraphicsBeginImageContextè¿”å›å®ƒçš„ç¤ºä¾‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">-(UIImage *)reverseImageForText:(NSString *)text&#123;</div><div class="line"></div><div class="line">const size_t kImageWidth = 200;</div><div class="line">const size_t kImageHeight = 200;</div><div class="line">CGImageRef textImage = NULL;</div><div class="line">UIFont *font = [UIFont preferredFontForTextStyle:UIFontTextStyleHeadline];</div><div class="line">UIColor *color = [UIColor redColor];</div><div class="line">UIGraphicsBeginImageContext(CGSizeMake(kImageWidth, kImageHeight));</div><div class="line">[text drawInRect:CGRectMake(0, 0, kImageWidth, kImageHeight) withAttributes:@&#123;NSFontAttributeName: font, NSForegroundColorAttributeName: color&#125;];</div><div class="line">//UIImage -&gt; CGImage</div><div class="line">textImage = UIGraphicsGetImageFromCurrentImageContext().CGImage;</div><div class="line"></div><div class="line">UIGraphicsEndImageContext();</div><div class="line">//orientation: æ–¹å‘ï¼Œ UIImageOrientationDownMirroredå›¾ç‰‡æ°´å¹³åè½¬</div><div class="line">return [UIImage imageWithCGImage:textImage scale:1.0 orientation:UIImageOrientationDownMirrored];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="http://om86drpkf.bkt.clouddn.com/Simulator%20Screen%20Shot%202017%E5%B9%B43%E6%9C%8819%E6%97%A5%20%E4%B8%8B%E5%8D%8810.44.15.png"></p>
<p>9 ä¼˜åŒ–UIViewç»˜åˆ¶<br>UIViewæå…¶å­ç±»æ˜¯é«˜åº¦ä¼˜åŒ–çš„ï¼Œå¯ä»¥çš„è¯ï¼Œè¯·å°½é‡ä½¿ç”¨å®ƒä»¬ï¼Œè€Œä¸è¦ä½¿ç”¨è‡ªå®šä¹‰ç»˜å›¾ã€‚</p>
<p>9.1 é¿å…ç»˜å›¾<br>æœ€å¿«çš„ç»˜å›¾æ–¹å¼å°±æ˜¯æ ¹æœ¬ä¸ç»˜åˆ¶ã€‚ğŸ‘‰iOSç«­å°½å…¨åŠ›é¿å…è°ƒç”¨drawRect:æ–¹æ³•ğŸ‘ˆã€‚å®ƒğŸ˜¨ç¼“å­˜äº†è§†å›¾çš„å›¾åƒğŸ˜¨å¹¶å¯åœ¨å¼€å‘è€…ä¸ä»‹å…¥çš„æƒ…å†µä¸‹ç§»åŠ¨ã€æ—‹è½¬å¹¶ç¼©æ”¾å®ƒã€‚ä½¿ç”¨ä¸€ä¸ªåˆé€‚çš„contentMode,ç³»ç»Ÿåœ¨æ—‹è½¬æˆ–é‡æ–°è°ƒæ•´å¤§å°ä»¥è°ƒæ•´è§†å›¾æ—¶å°±ä¸éœ€è¦è°ƒç”¨drawRectï¼šæ–¹æ³•ã€‚å¯¼è‡´drawRectï¼šæ–¹æ³•è¿è¡Œçš„æœ€å¸¸è§çš„æƒ…å†µå°±æ˜¯è°ƒç”¨äº†setNeedsDisplayã€‚è¯·é¿å…è°ƒç”¨ä¸å¿…è¦çš„setNeedsDisplayã€‚è®°ä½ï¼ŒsetNeedsDisplayåªæ˜¯æ ‡è®°è§†å›¾éœ€è¦ç»˜åˆ¶ã€‚åœ¨å•ä¸ªå¾ªç¯äº‹ä»¶ä¸­è°ƒç”¨å¤šæ¬¡setNeedsDisplay,å®é™…ä¸Šå¹¶ä¸ä¼šæ¯”è°ƒç”¨ä¸€æ¬¡çš„æƒ…å†µæˆæœ¬æ›´é«˜ã€‚</p>
<ol>
<li><p>è‡ªå®šä¹‰ç»˜å›¾ä¸é¢„æ¸²æŸ“<br>ç®¡ç†å¤æ‚çš„ç»˜å›¾æœ‰ä¸¤ç§ä¸»è¦æ–¹æ³•ï¼š åˆ©ç”¨CGPathå’ŒCGGreadienté€šè¿‡ç¼–ç æ¥ç»˜åˆ¶ä»»æ„å›¾åƒï¼Œæˆ–è€…ä½¿ç”¨psè¿™æ ·çš„å›¾å½¢ç¨‹åºè¿›è¡Œé¢„æ¸²æŸ“å¹¶ä½œä¸ºå›¾ç‰‡å±•ç¤ºå‡ºæ¥ã€‚<br>ç„¶è€Œé¢„æ¸²æŸ“æœ‰å¤§é‡ç¼ºç‚¹ï¼š å¯¹å„ç§åˆ†è¾¨ç‡çš„ä¾èµ–ã€‚å¼€å‘è€…å¯èƒ½éœ€è¦ç®¡ç†å„ç§ç‰ˆæœ¬çš„å›¾ç‰‡ã€‚è‹¹æœå…¬å¸æœ€åˆé¼“åŠ±å¼€å‘äººå‘˜è¿›è¡Œé¢„æ¸²æŸ“ï¼Œå› ä¸ºæ—©æœŸçš„iPhoneè®¡ç®—æ¸å˜çš„é€Ÿåº¦ä¸å¤Ÿå¿«ã€‚ç°åœ¨è¿™ä¸ªé—®é¢˜å°±æ²¡æœ‰é‚£ä¹ˆæ˜æ˜¾äº†ã€‚<br>ç›®å‰ï¼Œæ¨èå¼€å‘è€…åœ¨ä»£ç é‡åˆé€‚çš„æƒ…å†µä¸‹ï¼Œå°½é‡è¿›è¡Œè‡ªå®šä¹‰ç»˜å›¾ã€‚è¿™ä¸»è¦é€‚ç”¨äºåƒæŒ‰é’®è¿™æ ·çš„å°å…ƒç´ ã€‚è‹¥ä½¿ç”¨äº†é¢„æ¸²æŸ“ç»˜å›¾ï¼Œå»ºè®®ä¿æŒæ–‡ä»¶çš„â€œç®€æ´â€å¹¶åœ¨ä»£ç ä¸­è¿›è¡ŒåŠ å·¥ã€‚æ¯”å¦‚è¯´ï¼Œå¼€å‘è€…å¯èƒ½ä¼šç”¨ä¸€å¼ å›¾ç‰‡ä½œä¸ºæŒ‰é’®çš„èƒŒæ™¯ï¼Œå¹¶åœ¨ä»£ç ä¸­å¤„ç†å®ƒçš„åœ†è§’ä¸é˜´å½±ã€‚è¿™æ ·çš„è¯ï¼Œæ¯å½“å¼€å‘è€…éœ€è¦ä½œå‡ºç»†å¾®çš„è°ƒæ•´ï¼Œå°±ä¸éœ€è¦é‡ç°æ¸²æŸ“èƒŒæ™¯äº†ã€‚</p>
</li>
<li><p>åƒç´ å¯¹é½ä¸æ¨¡ç³Šæ–‡æœ¬<br>ä¸€ä¸ªæ˜“å¼•èµ·å¾®å¦™ç»˜å›¾é—®é¢˜çš„æå¸¸è§çš„åŸå› å°±æ˜¯åƒç´ ä¸å¯¹é½ã€‚å¦‚æœè¦Core Graphicsåœ¨æŸä¸ªæ²¡æœ‰å¯¹é½åƒç´ çš„ç‚¹è¿›è¡Œç»˜åˆ¶ï¼Œå®ƒå°†å‡ºç°é”¯é½¿ã€‚é™¤éå¯¹åƒç´ ç²¾åº¦è¦æ±‚ç‰¹åˆ«é«˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¦ç¡®ä¿ä½¿ç”¨æ•´å‹åæ ‡ã€‚</p>
</li>
</ol>
<p>é€šå¸¸ï¼Œå›¾å½¢ä¸­å¿ƒä¼šå½±å“åƒç´ å¯¹é½ã€‚å› æ­¤ï¼Œcenterå±æ€§ä¼šå¸¦æ¥éº»çƒ¦ã€‚å¦‚æœå°†ä¸­å¿ƒè®¾ç½®ä¸ºä¸€ä¸ªæ•´å‹åæ ‡ï¼ŒåŸç‚¹å°±å¯èƒ½å‡ºç°ä¸å¯¹é½ã€‚å°¤å…¶è¦æ³¨æ„æ–‡æœ¬ä¸å¯¹é½çš„æƒ…å†µï¼Œç‰¹åˆ«æ˜¯UILabelã€‚è§£å†³çš„åŠæ³•æœ‰ä¸¤ç§ï¼Œé¦–å…ˆï¼Œå­—ä½“å¤§å°ä¸ºå¥‡æ•°ï¼ˆæ¯”å¦‚13è€Œä¸æ˜¯12ï¼‰ä¸€èˆ¬å¯ä»¥æ­£ç¡®å¯¹é½ã€‚å¦‚æœä¹ æƒ¯ä½¿ç”¨å¥‡æ•°å·å­—ä½“é€šå¸¸å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚è¦ç¡®å®šé¿å…äº†è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦ç¡®ä¿é€šè¿‡setFrameï¼šæ–¹æ³•æˆ–åƒsetAlignedCenterï¼šè¿™æ ·çš„UIViewåˆ†ç±»è®¾ç½®å›¾å½¢ä¸ºæ•´å‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">-(void)setAlignedCenter:(CGPoint)center&#123;</div><div class="line">    self.center = center;</div><div class="line">    self.frame = CGRectIntegral(self.frame);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ol>
<li>é€æ˜ã€ä¸é€æ˜ä¸éšè—</li>
</ol>
<p>æ˜¯å¦å°†è§†å›¾æ ‡è®°ä¸ºopaqueå¹¶ä¸ä¼šå®é™…å‡é«˜æˆ–é™ä½å®ƒçš„é€æ˜åº¦ã€‚ç»˜å›¾ç³»ç»Ÿå¯ä»¥ä½¿ç”¨opaqueè¿›è¡Œä¼˜åŒ–ã€‚å½“è§†å›¾æ ‡è®°ä¸ºopaqueï¼Œä¾¿æ˜¯å‘ç»˜å›¾ç³»ç»Ÿâ€è®¸è¯ºâ€å³å°†ç»˜åˆ¶çš„æ¯ä¸€ä¸ªåƒç´ éƒ½è¦ä½¿ç”¨ä¸é€æ˜çš„é¢œè‰²ã€‚è¿™ä¾¿å…è®¸ç»˜å›¾ç³»ç»Ÿå¿½ç•¥è¢«è¦†ç›–åœ¨ä¸‹é¢çš„è§†å›¾ï¼Œè¿™æ ·å¯ä»¥æ”¹å–„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨è¿›è¡Œå˜å½¢æ—¶ã€‚å¼€å‘è€…åº”è¯¥å°½é‡å°†è§†å›¾æ ‡è®°ä¸ºopaqueï¼Œå°¤å…¶æ˜¯åƒUITableViewCellè¿™æ ·å¯ä»¥æ»šåŠ¨çš„è§†å›¾ã€‚ä¸è¿‡ï¼Œå¦‚æœè§†å›¾æœ‰ç‰¹å®šçš„é€æ˜åŒºåŸŸï¼Œæˆ–è€…å¹¶ä¸ç»˜åˆ¶çŸ©å½¢çš„æ‰€æœ‰å…ƒç´ ï¼Œè®¾ç½®opaqueä¼šå¯¼è‡´ä¸å¯é¢„æµ‹çš„ç»“æœã€‚</p>
<p>éšè—å’Œé€æ˜è§†å›¾å¹¶ä¸æ¥æ”¶è§¦æ‘¸äº‹ä»¶ã€‚ä¸èƒ½é€šè¿‡è®¾ç½®éå¸¸ä½çš„alphaæ¥åˆ›å»ºâ€é€æ˜è¦†ç›–å±‚â€ï¼Œä»è€Œæ•æ‰è§¦æ‘¸äº‹ä»¶ã€‚<br>å¯ä»¥åˆ›å»ºä¸€ä¸ªé€æ˜è§†å›¾å¹¶é€šè¿‡è®¾ç½®å®ƒçš„alphaå€¼ä¸º1ï¼Œopaqueä¸ºNOï¼Œä¸”backgroundColorä¸ºnilæˆ–[UIColor clearColor],æ¥æ¥æ”¶è§¦æ‘¸äº‹ä»¶ã€‚</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/03/18/åˆ©ç”¨è¿è¡Œæ—¶å…³è”å¯¹è±¡ä½¿ç”¨ç¤ºä¾‹/" rel="next" title="åˆ©ç”¨è¿è¡Œæ—¶å…³è”å¯¹è±¡ä½¿ç”¨ç¤ºä¾‹">
                <i class="fa fa-chevron-left"></i> åˆ©ç”¨è¿è¡Œæ—¶å…³è”å¯¹è±¡ä½¿ç”¨ç¤ºä¾‹
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/03/19/inline-å†…è”å‡½æ•°/" rel="prev" title="inline å†…è”å‡½æ•°">
                inline å†…è”å‡½æ•° <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/03/18/æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶/"
           data-title="æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶" data-url="http://yoursite.com/2017/03/18/æ›´å®Œå–„çš„è‡ªå®šä¹‰ç»˜åˆ¶/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/IMG_0084.png"
               alt="é¢ å€’" />
          <p class="site-author-name" itemprop="name">é¢ å€’</p>
           
              <p class="site-description motion-element" itemprop="description">ç«‹å¿—åšä¸€ä¸ªå±Œä¸</p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">27</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">é¢ å€’</span>
</div>


<div class="powered-by">
   ç¢ç¢å¿µ 
</div>

<div class="theme-info">
  ä¸ªäººä¸“å±åšå®¢ ä¸èƒ½æ‘†è„±æœ¬èƒ½çš„ç”·äººç®—ä¸ä¸Šç”·å­æ±‰
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"tcjing"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  













  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="local-search-pop-overlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  


  

</body>
</html>
